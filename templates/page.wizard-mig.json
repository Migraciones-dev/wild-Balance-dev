/*
 * ------------------------------------------------------------
 * IMPORTANT: The contents of this file are auto-generated.
 *
 * This file may be updated by the Shopify admin theme editor
 * or related systems. Please exercise caution as any changes
 * made to this file may be overwritten.
 * ------------------------------------------------------------
 */
{
  "sections": {
    "heading": {
      "type": "heading-template",
      "blocks": {
        "b49343f1-a16f-4a0c-834a-46b77fe777da": {
          "type": "1",
          "settings": {
            "heading": "",
            "fontf": "2",
            "text_cl": "#004623",
            "text_fs": 50,
            "text_lh": 56,
            "text_fw": 900,
            "text_ls": 0,
            "font_italic": false,
            "font_uppercase": false,
            "text_shadow": false,
            "mgb": 0,
            "text_fs_tb": 30,
            "text_lh_tb": 46,
            "text_ls_tb": 0,
            "mgb_tb": 0,
            "hidden_mobile": false,
            "text_fs_mb": 30,
            "text_lh_mb": 46,
            "text_ls_mb": 0,
            "mgb_mb": 0
          }
        },
        "46ff9c32-9810-4c24-b2bd-9c6e38cc2ea8": {
          "type": "3",
          "disabled": true,
          "settings": {
            "breadcrumb_color": "#868686",
            "breadcrumb_color_link": "#000000",
            "brc_mgb": 0
          }
        }
      },
      "block_order": [
        "b49343f1-a16f-4a0c-834a-46b77fe777da",
        "46ff9c32-9810-4c24-b2bd-9c6e38cc2ea8"
      ],
      "disabled": true,
      "settings": {
        "parallax": false,
        "color": "#000000",
        "overlay": 0,
        "padding_top": 50,
        "padding_bottom": 50,
        "mg_b": 50,
        "padding_top_tb": 50,
        "padding_bottom_tb": 50,
        "mg_btb": 50,
        "padding_top_mb": 50,
        "padding_bottom_mb": 0,
        "mg_bmb": 27,
        "box_border": "none",
        "bg_pos": "center center",
        "bg_repeat": "no-repeat",
        "bg_size": "cover"
      }
    },
    "2fa35883-7762-4b11-9a64-3e08390ea41e": {
      "type": "custom-liquid",
      "settings": {
        "custom_liquid": "<div class=\"headerWizard\">\n<section class=\"logo\">\n<a href=\"https://wildbalance.es/\">\n<img src=\"https://cdn.shopify.com/s/files/1/0713/9898/1933/files/LOGO_1_1.png?v=1699453886\"/>\n</a>\n</section>\n\n<section class=\"wizardBubbleDiscount\">\n<div>\n<p>10% DESCUENTO</p>\n</div>\n</section>\n</div>"
      }
    },
    "custom_liquid_ibzxRE": {
      "type": "custom-liquid",
      "disabled": true,
      "settings": {
        "custom_liquid": "{% render 'wizard-resultpage-js' %}"
      }
    },
    "17007363095c6db749": {
      "type": "apps",
      "blocks": {
        "0ffae087-4c23-4da3-ad42-99aef600abfa": {
          "type": "shopify://apps/revenuehunt-quizzes/blocks/inline-quiz/672f3d48-fd3b-4227-8778-c6e58c4f8a98",
          "settings": {
            "quiz_id": "7jHvyKp",
            "quiz_height": 735,
            "quiz_autoscroll": false,
            "quiz_fixed_height": true
          }
        }
      },
      "block_order": [
        "0ffae087-4c23-4da3-ad42-99aef600abfa"
      ],
      "settings": {}
    },
    "custom_liquid_BqAicP": {
      "type": "custom-liquid",
      "disabled": true,
      "name": "Custom Liquid",
      "settings": {
        "custom_liquid": "<div id=\"wizard-result-root\"></div>\n\n\n<script>\n  window.prqQuizCallback = function(quizResponse){\n    // Guarda el payload por si el server falla (lo usaremos en la página de resultados)\n    try { localStorage.setItem('prq_last_response', JSON.stringify(quizResponse)); } catch(e){}\n\n    // ID de resultado (en tus logs aparece como response.id o responseId)\n    var rid = quizResponse?.response?.id || quizResponse?.responseId || null;\n\n    // Opción B (si quisieras ir a la vista nativa del widget):\n    // var permalink = quizResponse?.response?.attributes?.permalink; // ej: https://wildbalance.es/#results-<quizid>-<rid>\n    // if (permalink) { window.location.replace(permalink); return; }\n\n    // Tu página de resultados (sin 404), pasando el id por querystring\n    var base = \"https://wildbalance.es/pages/wizard-result\";\n    var url  = rid ? (base + \"?rid=\" + encodeURIComponent(rid)) : base;\n\n    console.log(\"[prqQuizCallback] redirect ->\", url);\n    window.location.replace(url); // replace para no dejar el paso intermedio en el historial\n  };\n</script>\n<script>\n(function(){\n  var root = document.getElementById('wizard-result-root');\n\n  function htmlEscape(str){\n    return String(str).replace(/[&<>\"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#039;'}[s]));\n  }\n\n  function renderResultDesdeLocal(data){\n    if (!data || !data.response) { root.innerHTML = \"<p>No hay datos de resultado.</p>\"; return; }\n    var attrs = data.response.attributes || {};\n    var quizId = data.quiz?.id || data.quizid || \"\";\n    var rid    = data.response?.id || data.responseId || \"\";\n\n    // Extrae algunos campos útiles si existen\n    var selectedResultId = attrs.selected_result_id || attrs.selected_result?.data?.id || \"\";\n    var tags = Array.isArray(attrs.tags) ? attrs.tags : [];\n    var products = Array.isArray(attrs.recommended_products) ? attrs.recommended_products : [];\n\n    // Pinta algo útil y rápido\n    var html = `\n      <div class=\"tws\">\n        <h2 class=\"t4s_mb__10\">Resultados del quiz</h2>\n        <p><strong>Quiz:</strong> ${htmlEscape(quizId)} · <strong>Respuesta:</strong> ${htmlEscape(rid)}</p>\n        ${selectedResultId ? `<p><strong>Resultado seleccionado:</strong> ${htmlEscape(selectedResultId)}</p>` : \"\" }\n        ${tags.length ? `<p><strong>Tags:</strong> ${tags.map(htmlEscape).join(\", \")}</p>` : \"\" }\n\n        ${products.length ? `\n          <h3 class=\"t4s_mt__15 t4s_mb__5\">Productos recomendados (${products.length})</h3>\n          <ul>\n            ${products.map(p => {\n              // p puede venir en distintos formatos; mostramos lo básico de forma segura\n              var name = p.title || p.name || p.product_title || p.handle || \"[Producto]\";\n              var url  = p.url || p.product_url || p.href || null;\n              return `<li>${url ? `<a href=\"${htmlEscape(url)}\">${htmlEscape(name)}</a>` : htmlEscape(name)}</li>`;\n            }).join(\"\")}\n          </ul>\n        ` : \"<p>No hay productos recomendados.</p>\"}\n\n        <details class=\"t4s_mt__15\">\n          <summary>Ver JSON completo (debug)</summary>\n          <pre style=\"white-space:pre-wrap\">${htmlEscape(JSON.stringify(data, null, 2))}</pre>\n        </details>\n      </div>\n    `;\n    root.innerHTML = html;\n  }\n\n  // 1) Lee rid de la URL (?rid=ID) o del hash (#ID) como respaldo\n  var params = new URLSearchParams(location.search);\n  var rid = params.get('rid') || (location.hash ? location.hash.slice(1) : null);\n\n  // 2) Carga el último payload guardado por el callback\n  var saved = null;\n  try { saved = JSON.parse(localStorage.getItem('prq_last_response') || 'null'); } catch(e){}\n\n  // 3) Verifica que el payload corresponde a ese rid; si no llegó rid, pinta igualmente\n  if (saved && ( !rid || saved.response?.id === rid || saved.responseId === rid )) {\n    renderResultDesdeLocal(saved);\n  } else if (!saved) {\n    root.innerHTML = \"<p>No se encontró el resultado en este navegador. Repite el quiz.</p>\";\n  } else {\n    // Hay datos pero no coinciden con el rid → pinta lo que hay y avisa\n    renderResultDesdeLocal(saved);\n    console.warn(\"El rid de la URL no coincide con el guardado. Asegúrate de venir del quiz.\");\n  }\n})();\n</script>"
      }
    },
    "main": {
      "type": "main-page",
      "settings": {
        "layout": "t4s-container-wrap",
        "cl_bg": "",
        "cl_bg_gradient": "",
        "mg": "60px,100px,60px,100px",
        "pd": "",
        "mg_tb": "20px,10px,30px,10px",
        "pd_tb": "",
        "mg_mb": "10px,10px,30px,10px",
        "pd_mb": ""
      }
    },
    "custom_liquid_HBy9ba": {
      "type": "custom-liquid",
      "settings": {
        "custom_liquid": "<style>\ndiv.rh-fullwidth .rh-widget.rh-inline.rh-quiz-GrHkMm{\n  height: 100vh !important;\n}\n</style>"
      }
    }
  },
  "order": [
    "heading",
    "2fa35883-7762-4b11-9a64-3e08390ea41e",
    "custom_liquid_ibzxRE",
    "17007363095c6db749",
    "custom_liquid_BqAicP",
    "main",
    "custom_liquid_HBy9ba"
  ]
}
