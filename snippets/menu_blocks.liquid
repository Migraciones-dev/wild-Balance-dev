{%- comment -%}
  menu_blocks
  menu_splits
  bk_stts.lazy_mn and admin_sp == false
{%- endcomment -%}

{%- liquid
  assign root_url = routes.root_url
  assign showArrow = se_stts.arrow
  assign request_path = request.path
  unless limit_offset
    assign limit_offset = 0
  endunless
-%}

<nav class="t4s-navigation t4s-text-{{ se_stts.align }} t4s-nav__{{ se_stts.hover }} t4s-nav-arrow__{{ se_stts.arrow }}">
  <ul
    data-menu-nav
    id="t4s-nav-ul"
    class="t4s-nav__ul t4s-d-inline-flex t4s-flex-wrap t4s-align-items-center w-full justify-center"
  >
    {%- for block in se_blocks offset: limit_offset -%}
      {%- liquid
        if block.type == 'parent'
          break
        endif
        assign bk_stts = block.settings
        assign blockID = block.id
        assign bk_link = bk_stts.url
        assign bk_link_split = bk_link | split: '?' | first
        if request_path == bk_link_split and bk_link != blank
          assign class_active = 'is--nav__active'
        else
          assign class_active = ''
        endif
        if bk_link == '/' or bk_link == blank
          assign bk_link = root_url
        endif
      -%}

      {%- case block.type -%}
        {%- when 'mega' -%}
          {%- assign pd_content = bk_stts.padding_inner_bn | remove: ' ' | split: ',' %}
          <li
            id="item_{{ blockID }}"
            data-placement="{{ bk_stts.pos_sub | default: placement }}"
            class="t4s-type__{{ block.type }} menu-width__{{ bk_stts.wid }} t4s-menu-item has--children menu-has__offsets {{ class_active }}"
            {{ block.shopify_attributes }}
            style="--pd-mg: {{ pd_content[0] | default: 0 }} {{ pd_content[1] | default: 0 }} {{ pd_content[2] | default: 0 }} {{ pd_content[3] | default: 0 }};"
          >
            <a
              class="t4s-lh-1 t4s-d-flex t4s-align-items-center t4s-pr tracking-[1px] capitalize"
              href="{{ bk_link }}"
              target="{{ bk_stts.open_link }}"
              {% if bk_stts.cus_cl %}
                style="color: {{ bk_stts.cl }}"
              {% endif %}
            >
              {%- render 'title_menu', bk_stts: bk_stts, showArrow: showArrow -%}
            </a>
            <div
              id="content_{{ blockID }}"
              class="t4s-sub-menu t4s-pa t4s-op-0 t4s-pe-none t4s-current-scrollbar !bg-[#F4F0E2]"
            >
              <div
                class="t4s-container"
                {% if bk_stts.wid != 'full nav_t4cnt' %}
                  style="width: {{ bk_stts.cus_wid }}px"
                {% endif %}
              >
                {% if bk_stts.mg_sub_hd != blank and bk_stts.use_sub_heading %}
                  <h5 class="t4s-heading-menu t4s-d-block">{{ bk_stts.mg_sub_hd }}</h5>
                {% endif %}
                <div
                  class=""
                >
                  <div class="flex flex-row gap-12">
                    <div class="w-1/5 flex flex-col">
                      {% comment %}<img src="https://cdn.shopify.com/s/files/1/0713/9898/1933/files/Background_1.jpg?v=1754217207">{% endcomment %}
                      <a href="#" class="font-extrabold [font-family:'Barlow',Helvetica]  text-[#004623] text-[25px]"
                        >VER TODOS</a
                      >
                      {% comment %}
                        <button class="px-16 py-6 bg-yellow-400 hover:bg-yellow-500  rounded-full font-medium transition shadow-xl text-[#004623] w-fit">
                          VER TODOS
                        </button>
                      {% endcomment %}
                    </div>

                    <div class="grid grid-cols-2 lg:grid-cols-3 gap-8 w-full">
                      {% for link in linklists[bk_stts.menu].links %}
                        {% assign obj = link.object %}
                        <a
                          href="{{ link.url }}"
                          class="flex items-center bg-white shadow border border-[#D9D9C8] rounded-[8px]  w-full h-[117px] overflow-hidden"
                        >
                          <!-- Imagen -->
                          {% if obj.metafields.custom.imagen_para_el_mega_menu %}
                            <div class="flex-shrink-0 w-[134px] h-full">
                              <img
                                src="{{ obj.metafields.custom.imagen_para_el_mega_menu | file_url }}"
                                alt="{{ link.title }}"
                                class="w-full h-full object-cover p-2 rounded-[8px] "
                              >
                            </div>
                          {% endif %}
                          <!-- Texto -->
                          <div class="flex-1 pl-4 [font-family:'Barlow',Helvetica]  text-[#004623] px-6">
                            <p class="font-bold text-[20px] leading-[25px] leading-[25px]">{{ link.title }}</p>
                            <p class="text-[14px]">
                              {{ obj.metafields.custom.subtitulo_para_el_mega_menu }}
                            </p>
                          </div>
                        </a>
                      {% endfor %}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </li>

        {%- when 'drop' -%}
          <li
            id="item_{{ blockID }}"
            data-placement="{{ bk_stts.pos_sub | default: placement }}"
            class="t4s-type__{{ block.type }} t4s-menu-item has--children menu-has__offsets {{ class_active }}"
            style="--t4s-w-drop: {{ bk_stts.cus_wid }}px"
            {{ block.shopify_attributes }}
          >
            <a
              class="t4s-lh-1 t4s-d-flex t4s-align-items-center t4s-pr tracking-[1px] capitalize"
              href="{{ bk_link }}"
              target="{{ bk_stts.open_link }}"
              {% if bk_stts.cus_cl %}
                style="color: {{ bk_stts.cl }}"
              {% endif %}
            >
              {%- render 'title_menu', bk_stts: bk_stts, showArrow: showArrow -%}
            </a>
            {%- if linklists[bk_stts.menu].links.size > 0 -%}
              <div id="content_{{ blockID }}" class="t4s-sub-menu t4s-pa t4s-op-0 t4s-pe-none t4s-current-scrollbar">
                {%- if admin_sp == false -%}
                  <div class="t4s-lazy_menu" data-handle="{{ bk_stts.menu }}"><div class="t4s-loading--bg"></div></div>
                {%- else -%}
                  <div class="t4s-lazy_menu">{%- render 'menu_dropdown', handle_menu: bk_stts.menu -%}</div>
                {%- endif -%}
              </div>
            {%- endif -%}
          </li>

        {%- else -%}
          <li
            id="item_{{ blockID }}"
            class="t4s-type__simple t4s-menu-item {{ class_active }}"
            {{ block.shopify_attributes }}
          >
            <a
              class="t4s-lh-1 t4s-d-flex t4s-align-items-center t4s-pr tracking-[1px] capitalize"
              href="{{ bk_link }} "
              target="{{ bk_stts.open_link }}"
              {% if bk_stts.cus_cl %}
                style="color: {{ bk_stts.cl }}"
              {% endif %}
            >
              {%- render 'title_menu', bk_stts: bk_stts, showArrow: false -%}
            </a>
          </li>
      {%- endcase -%}
    {%- else -%}
      <style>
        #shopify-section-header-e-commerce .t4s-section-header__bot {display: none !important;}
      </style>
    {%- endfor -%}
  </ul>
</nav>
