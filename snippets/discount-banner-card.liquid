{%- comment -%}
  Snippet: discount-banner-card.liquid
  Uso: {% render 'discount-banner-card', banner_image: image, action_type: type, link_url: url, banner_product: product %}
{%- endcomment -%}

<div class="discount-banner-card bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition-shadow relative h-full">
  <div class="relative w-full" style="aspect-ratio: 2/1;">
    {% if banner_image %}
      {% if action_type == 'link' and link_url != blank %}
        <a href="{{ link_url }}" class="block w-full h-full">
          <img
            src="{{ banner_image | img_url: '1200x' }}"
            alt="{{ banner_image.alt | escape }}"
            class="w-full h-full object-cover"
            loading="lazy"
          >
        </a>
      {% elsif action_type == 'product' and banner_product %}
        <img
          src="{{ banner_image | img_url: '1200x' }}"
          alt="{{ banner_image.alt | escape }}"
          class="w-full h-full object-cover"
          loading="lazy"
        >

        {%- liquid
          assign current_variant = banner_product.selected_or_first_available_variant
          assign isDefault = banner_product.has_only_default_variant
          assign pid = banner_product.id
        -%}

        {%- comment -%} Bot칩n a침adir al carrito dentro de la imagen {%- endcomment -%}
        {% if banner_product.available %}
          {% if isDefault %}
            <button
              class="add-to-cart-btn absolute bottom-4 left-1/2 -translate-x-1/2 px-6 bg-[#FFC107] text-[#004622] font-bold py-2.5 rounded-full transition-colors text-[10px] lg:text-[12px] whitespace-nowrap"
              data-variant-id="{{ current_variant.id }}"
              data-product-id="{{ pid }}"
              data-product-available="true"
              data-has-variants="false"
            >
              A침adir al carrito
            </button>
          {% else %}
            <button
              class="add-to-cart-btn absolute bottom-4 left-1/2 -translate-x-1/2 px-6 bg-[#FFC107] text-[#004622] font-bold py-2.5 rounded-full transition-colors text-[10px] lg:text-[12px] whitespace-nowrap"
              data-product-id="{{ pid }}"
              data-product-url="{{ banner_product.url }}"
              data-has-variants="true"
              data-action-quickview
            >
              A침adir al carrito
            </button>
          {% endif %}
        {% else %}
          <button
            class="absolute bottom-4 left-1/2 -translate-x-1/2 px-6 bg-gray-300 text-gray-600 font-bold py-2.5 rounded-full cursor-not-allowed text-[10px] lg:text-[12px] whitespace-nowrap"
            disabled
          >
            Agotado
          </button>
        {% endif %}
      {% else %}
        <img
          src="{{ banner_image | img_url: '1200x' }}"
          alt="{{ banner_image.alt | escape }}"
          class="w-full h-full object-cover"
          loading="lazy"
        >
      {% endif %}
    {% else %}
      <div class="w-full h-full flex items-center justify-center text-gray-400">Sin imagen de banner</div>
    {% endif %}
  </div>
</div>
