<section
  id="section-{{ section.id }}"
  class="w-full"
  style="
    background-color: {{ section.settings.outer_bg_color }};
    padding-top: {{ section.settings.pt_mobile }}px;
    padding-bottom: {{ section.settings.pb_mobile }}px;
  "
>
  <style>
    @media (min-width: 1024px) {
      #section-{{ section.id }} {
        padding-top: {{ section.settings.pt_desktop }}px !important;
        padding-bottom: {{ section.settings.pb_desktop }}px !important;
      }
    }

    /* Contenedor interno con fondo y border radius */
    #section-{{ section.id }} .inner-wrapper {
      background-color: {{ section.settings.bg_color }};
      border-radius: {{ section.settings.border_radius }}px;
      padding: {{ section.settings.inner_padding_mobile }}px;
    }

    @media (min-width: 1024px) {
      #section-{{ section.id }} .inner-wrapper {
        border-radius: {{ section.settings.border_radius_desktop }}px;
        padding: {{ section.settings.inner_padding_desktop }}px;
      }
    }

    /* Estilos para botones de tabs */
    .pet-tab-button {
      transition: all 0.3s ease;
      min-width: 100px;
      justify-content: center;
      font-size: 11px;
    }

    @media (min-width: 1024px) {
      .pet-tab-button {
        font-size: 17px;
      }
    }

    .pet-tab-button.active {
      background-color: #5CCC84;
      color: white;
      border-color: #5CCC84;
    }

    .pet-tab-button:not(.active) {
      background-color: transparent;
      color: #5CCC84;
      border-color: #5CCC84;
      border-width: 1px;
      border: 1px solid;
    }

    /* Estilos para categor铆as */
    .category-button {
      transition: all 0.3s ease;
      cursor: pointer;
      text-align: center;
      justify-content: center;
      font-size: 11px;
    }

    @media (min-width: 1024px) {
      .category-button {
        font-size: 17px;
      }
    }

    .category-button.active {
      background-color: {{ section.settings.accent_color }};
      color: white;
      border-color: {{ section.settings.accent_color }};
    }

    .category-button:not(.active) {
      background-color: transparent;
      color: #5CCC84;
      border-color: #5CCC84!important;
      border-width: 1px;
      border: 1px solid;
    }

    /* Carrusel horizontal en m贸vil */
    .categories-scroll::-webkit-scrollbar {
      display: none;
    }

    .categories-scroll {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    /* Grid de productos */
    .products-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    @media (min-width: 640px) {
      .products-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (min-width: 1024px) {
      .products-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 24px;
      }
    }

    /* Ancho m谩ximo del t铆tulo en desktop */
    @media (min-width: 1024px) {
      .title-container {
        max-width: 400px;
      }
    }

    /* Banner de 2 columnas */
    .banner-wide {
      grid-column: span 2;
    }

    @media (min-width: 1024px) {
      .banner-wide {
        grid-column: span 2;
      }
    }

    /* Colores de precios */
    #section-{{ section.id }} .product-price {
      color: {{ section.settings.price_color }};
    }

    #section-{{ section.id }} .product-compare-price {
      color: {{ section.settings.compare_price_color }};
      text-decoration: line-through;
    }

    /* FIX PARA MODAL */
    .t4s-modal.t4s-modal--is-active {
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 9999 !important;
    }

    .t4s-modal.t4s-modal--is-active .t4s-modal__inner {
      visibility: visible !important;
      opacity: 1 !important;
    }

    .t4s-modal.t4s-modal--is-active .t4s-modal__content {
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 10000 !important;
    }

    /* Fix para el contenedor del slider Flickity que tiene height: 0 */
    .t4s-modal--is-active .flickityt4s-viewport {
      height: auto !important;
      min-height: 500px !important;
    }

    .t4s-modal--is-active .flickityt4s-carousel {
      height: auto !important;
    }

    /* Asegurar que todo dentro del modal es visible */
    .t4s-modal--is-active [style*="height: 0"] {
      height: auto !important;
    }

    /* Fix para overlay */
    .t4s-modal__overlay {
      z-index: 9998 !important;
    }
  </style>

  <!-- Contenedor exterior con fondo de contraste -->
  <div class="inner-wrapper max-w-[1600px] mx-auto">
    <div class="max-w-[1600px] mx-auto px-6 lg:px-10">
      {%- comment -%} MVIL: T铆tulo arriba {%- endcomment -%}
      <div class="lg:hidden text-center mb-6">
        <h2 class="[font-family:'Barlow',Helvetica] font-extrabold text-[30px] sm:text-[38px] leading-[1] text-[{{ section.settings.title_color }}]">
          {{ section.settings.heading_before }}
          {% if section.settings.heading_highlight != blank %}
            <span class="highlight">{{ section.settings.heading_highlight }}</span>
          {% endif %}
          {{ section.settings.heading_after }}
        </h2>
      </div>

      {%- comment -%} MVIL: Botones Perro/Gato {%- endcomment -%}
      <div class="lg:hidden flex gap-2 justify-center mb-12 mt-12">
        <button
          class="pet-tab-button active px-12 py-4 rounded-full border-2 flex items-center gap-4 font-semibold"
          data-pet="dog"
        >
          <svg width="20" height="19" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.3578 7.84066L16.0838 1.01313C16.0527 0.846709 15.9878 0.688412 15.8933 0.547976C15.7987 0.407541 15.6764 0.287936 15.5339 0.196516C15.3914 0.105096 15.2317 0.0437944 15.0646 0.0163804C14.8975 -0.0110336 14.7266 -0.00398027 14.5624 0.0371066L14.5383 0.0440893L10.4635 1.24589H6.91786L2.84307 0.0479685L2.81902 0.0409858C2.65477 -0.000101054 2.48385 -0.00715435 2.31677 0.0202597C2.1497 0.0476737 1.99 0.108975 1.84749 0.200395C1.70498 0.291815 1.58268 0.41142 1.48811 0.551856C1.39354 0.692291 1.32869 0.850588 1.29757 1.01701L0.0236117 7.84066C-0.0308665 8.11394 0.00957196 8.39763 0.138238 8.6448C0.266904 8.89198 0.476089 9.08783 0.731192 9.19996C0.894594 9.27479 1.07207 9.31393 1.25179 9.31478C1.4669 9.31461 1.67803 9.25673 1.86316 9.1472V12.4182C1.86316 13.2413 2.19013 14.0306 2.77214 14.6127C3.35414 15.1947 4.14351 15.5216 4.96658 15.5216H12.4148C13.2379 15.5216 14.0272 15.1947 14.6092 14.6127C15.1912 14.0306 15.5182 13.2413 15.5182 12.4182V9.14797C15.7031 9.25738 15.914 9.31524 16.1288 9.31556C16.3087 9.31506 16.4865 9.27618 16.6502 9.20151C16.9056 9.08932 17.115 8.89323 17.2437 8.64572C17.3724 8.39822 17.4126 8.11417 17.3578 7.84066ZM1.24248 8.07341L2.51721 1.24589L5.78123 2.20562L1.24248 8.07341ZM12.4148 14.2803H9.31137V13.2957L10.3712 12.2367C10.4877 12.1202 10.5531 11.9622 10.5531 11.7975C10.5531 11.6328 10.4877 11.4749 10.3712 11.3584C10.2547 11.2419 10.0968 11.1765 9.93206 11.1765C9.76735 11.1765 9.60939 11.2419 9.49292 11.3584L8.69069 12.1614L7.88846 11.3584C7.77199 11.2419 7.61403 11.1765 7.44932 11.1765C7.28461 11.1765 7.12665 11.2419 7.01019 11.3584C6.89372 11.4749 6.82829 11.6328 6.82829 11.7975C6.82829 11.9622 6.89372 12.1202 7.01019 12.2367L8.07001 13.2957V14.2803H4.96658C4.47274 14.2803 3.99912 14.0841 3.64991 13.7349C3.30071 13.3857 3.10453 12.9121 3.10453 12.4182V7.69402L7.13277 2.48726H10.2478L14.2768 7.69402V12.4182C14.2768 12.9121 14.0807 13.3857 13.7315 13.7349C13.3823 14.0841 12.9086 14.2803 12.4148 14.2803ZM16.1389 8.07341L11.6001 2.20562L14.8642 1.24589L16.1389 8.07341ZM6.82864 9.00444C6.82864 9.18858 6.77403 9.36858 6.67173 9.52169C6.56943 9.6748 6.42402 9.79413 6.2539 9.8646C6.08378 9.93506 5.89658 9.9535 5.71598 9.91758C5.53538 9.88165 5.36948 9.79298 5.23928 9.66278C5.10907 9.53257 5.0204 9.36668 4.98447 9.18607C4.94855 9.00547 4.96699 8.81828 5.03746 8.64815C5.10792 8.47803 5.22725 8.33262 5.38036 8.23032C5.53347 8.12802 5.71347 8.07341 5.89761 8.07341C6.14453 8.07341 6.38134 8.1715 6.55595 8.34611C6.73055 8.52071 6.82864 8.75752 6.82864 9.00444ZM12.4148 9.00444C12.4148 9.18858 12.3602 9.36858 12.2579 9.52169C12.1556 9.6748 12.0102 9.79413 11.8401 9.8646C11.6699 9.93506 11.4827 9.9535 11.3021 9.91758C11.1215 9.88165 10.9556 9.79298 10.8254 9.66278C10.6952 9.53257 10.6066 9.36668 10.5706 9.18607C10.5347 9.00547 10.5531 8.81828 10.6236 8.64815C10.6941 8.47803 10.8134 8.33262 10.9665 8.23032C11.1196 8.12802 11.2996 8.07341 11.4838 8.07341C11.7307 8.07341 11.9675 8.1715 12.1421 8.34611C12.3167 8.52071 12.4148 8.75752 12.4148 9.00444Z"/>
          </svg>
          <span>Perros</span>
        </button>

        <button
          class="pet-tab-button px-12 py-4 rounded-full border-2 flex items-center gap-4 font-semibold"
          data-pet="cat"
        >
          <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6.77531 10.1623C6.77531 10.3856 6.70909 10.6039 6.58501 10.7896C6.46093 10.9753 6.28456 11.1201 6.07823 11.2055C5.87189 11.291 5.64484 11.3134 5.42579 11.2698C5.20675 11.2262 5.00554 11.1187 4.84762 10.9607C4.68969 10.8028 4.58214 10.6016 4.53857 10.3826C4.495 10.1635 4.51736 9.93648 4.60283 9.73014C4.6883 9.5238 4.83303 9.34744 5.01873 9.22336C5.20443 9.09928 5.42276 9.03305 5.64609 9.03305C5.94558 9.03305 6.2328 9.15202 6.44457 9.36379C6.65634 9.57556 6.77531 9.86278 6.77531 10.1623ZM13.927 9.03305C13.7037 9.03305 13.4854 9.09928 13.2997 9.22336C13.114 9.34744 12.9692 9.5238 12.8838 9.73014C12.7983 9.93648 12.7759 10.1635 12.8195 10.3826C12.8631 10.6016 12.9706 10.8028 13.1286 10.9607C13.2865 11.1187 13.4877 11.2262 13.7067 11.2698C13.9258 11.3134 14.1528 11.291 14.3592 11.2055C14.5655 11.1201 14.7419 10.9753 14.8659 10.7896C14.99 10.6039 15.0562 10.3856 15.0562 10.1623C15.0562 9.86278 14.9373 9.57556 14.7255 9.36379C14.5137 9.15202 14.2265 9.03305 13.927 9.03305ZM19.5731 1.50493V9.78587C19.5731 14.7667 15.1833 18.8196 9.78656 18.8196C4.38984 18.8196 0 14.7667 0 9.78587V1.50493C0.00013794 1.20724 0.0885161 0.916283 0.253966 0.668813C0.419415 0.421342 0.65451 0.22847 0.929542 0.11457C1.20457 0.000670666 1.5072 -0.0291444 1.79917 0.0288927C2.09114 0.0869299 2.35935 0.230214 2.56991 0.440639C2.58309 0.453813 2.59438 0.466047 2.60567 0.479221L4.23457 2.35184C5.90011 1.30833 7.82583 0.7549 9.79127 0.7549C11.7567 0.7549 13.6824 1.30833 15.348 2.35184L16.9675 0.479221C16.9787 0.466047 16.99 0.453813 17.0032 0.440639C17.2138 0.230214 17.482 0.0869299 17.774 0.0288927C18.0659 -0.0291444 18.3686 0.000670666 18.6436 0.11457C18.9186 0.22847 19.1537 0.421342 19.3192 0.668813C19.4846 0.916283 19.573 1.20724 19.5731 1.50493ZM18.0675 1.50493L16.0387 3.83865C15.9146 3.98222 15.7408 4.07363 15.5522 4.09457C15.3636 4.11551 15.174 4.06443 15.0214 3.95157C14.5621 3.61203 14.0693 3.32036 13.5506 3.08113V5.26899C13.5506 5.46865 13.4713 5.66013 13.3301 5.80131C13.189 5.94249 12.9975 6.0218 12.7978 6.0218C12.5982 6.0218 12.4067 5.94249 12.2655 5.80131C12.1243 5.66013 12.045 5.46865 12.045 5.26899V2.54475C11.5511 2.41769 11.0475 2.33208 10.5394 2.28879V5.26899C10.5394 5.46865 10.4601 5.66013 10.3189 5.80131C10.1777 5.94249 9.98622 6.0218 9.78656 6.0218C9.5869 6.0218 9.39542 5.94249 9.25424 5.80131C9.11306 5.66013 9.03375 5.46865 9.03375 5.26899V2.28879C8.52563 2.33208 8.02201 2.41769 7.52812 2.54475V5.26899C7.52812 5.46865 7.44881 5.66013 7.30763 5.80131C7.16645 5.94249 6.97497 6.0218 6.77531 6.0218C6.57565 6.0218 6.38417 5.94249 6.24299 5.80131C6.10181 5.66013 6.0225 5.46865 6.0225 5.26899V3.08113C5.50383 3.32036 5.011 3.61203 4.55169 3.95157C4.39946 4.06476 4.2101 4.11631 4.02149 4.0959C3.83289 4.07548 3.65895 3.98462 3.53445 3.84147L1.50563 1.50493V9.78587C1.50563 13.7061 4.81894 16.9376 9.03375 17.2829V15.367L7.74832 14.0816C7.67844 14.0117 7.62302 13.9286 7.58522 13.8373C7.54743 13.7459 7.528 13.648 7.52804 13.5491C7.52808 13.4503 7.5476 13.3524 7.58548 13.261C7.62335 13.1697 7.67885 13.0867 7.74879 13.0168C7.89005 12.8757 8.08159 12.7965 8.28127 12.7966C8.38014 12.7966 8.47804 12.8161 8.56937 12.854C8.6607 12.8919 8.74367 12.9474 8.81355 13.0173L9.78656 13.9903L10.7596 13.0173C10.8295 12.9474 10.9124 12.8919 11.0038 12.854C11.0951 12.8161 11.193 12.7966 11.2919 12.7966C11.3907 12.7965 11.4886 12.8159 11.58 12.8537C11.6714 12.8915 11.7544 12.947 11.8243 13.0168C11.8943 13.0867 11.9498 13.1697 11.9876 13.261C12.0255 13.3524 12.045 13.4503 12.0451 13.5491C12.0451 13.648 12.0257 13.7459 11.9879 13.8373C11.9501 13.9286 11.8947 14.0117 11.8248 14.0816L10.5394 15.367V17.2829C14.7542 16.9357 18.0675 13.7071 18.0675 9.78587V1.50493Z"/>
          </svg>
          <span>Gatos</span>
        </button>
      </div>

      {%- comment -%} DESKTOP: Header con t铆tulo y botones {%- endcomment -%}
      <div class="hidden lg:flex lg:items-center lg:justify-between mb-12">
        <div class="title-container">
          <h2
            class="[font-family:'Barlow',Helvetica] font-extrabold text-[57px] xl:text-[64px] leading-[1]"
            style="color: {{ section.settings.title_color }};"
          >
            {{ section.settings.heading_before }}
            {% if section.settings.heading_highlight != blank %}
              <span class="highlight">{{ section.settings.heading_highlight }}</span>
            {% endif %}
            {{ section.settings.heading_after }}
          </h2>
        </div>

        <div class="flex gap-3">
          <button
            class="pet-tab-button active px-12 py-4 rounded-full border-2 flex items-center gap-4 font-semibold"
            data-pet="dog"
          >
            <svg width="20" height="19" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M17.3578 7.84066L16.0838 1.01313C16.0527 0.846709 15.9878 0.688412 15.8933 0.547976C15.7987 0.407541 15.6764 0.287936 15.5339 0.196516C15.3914 0.105096 15.2317 0.0437944 15.0646 0.0163804C14.8975 -0.0110336 14.7266 -0.00398027 14.5624 0.0371066L14.5383 0.0440893L10.4635 1.24589H6.91786L2.84307 0.0479685L2.81902 0.0409858C2.65477 -0.000101054 2.48385 -0.00715435 2.31677 0.0202597C2.1497 0.0476737 1.99 0.108975 1.84749 0.200395C1.70498 0.291815 1.58268 0.41142 1.48811 0.551856C1.39354 0.692291 1.32869 0.850588 1.29757 1.01701L0.0236117 7.84066C-0.0308665 8.11394 0.00957196 8.39763 0.138238 8.6448C0.266904 8.89198 0.476089 9.08783 0.731192 9.19996C0.894594 9.27479 1.07207 9.31393 1.25179 9.31478C1.4669 9.31461 1.67803 9.25673 1.86316 9.1472V12.4182C1.86316 13.2413 2.19013 14.0306 2.77214 14.6127C3.35414 15.1947 4.14351 15.5216 4.96658 15.5216H12.4148C13.2379 15.5216 14.0272 15.1947 14.6092 14.6127C15.1912 14.0306 15.5182 13.2413 15.5182 12.4182V9.14797C15.7031 9.25738 15.914 9.31524 16.1288 9.31556C16.3087 9.31506 16.4865 9.27618 16.6502 9.20151C16.9056 9.08932 17.115 8.89323 17.2437 8.64572C17.3724 8.39822 17.4126 8.11417 17.3578 7.84066ZM1.24248 8.07341L2.51721 1.24589L5.78123 2.20562L1.24248 8.07341ZM12.4148 14.2803H9.31137V13.2957L10.3712 12.2367C10.4877 12.1202 10.5531 11.9622 10.5531 11.7975C10.5531 11.6328 10.4877 11.4749 10.3712 11.3584C10.2547 11.2419 10.0968 11.1765 9.93206 11.1765C9.76735 11.1765 9.60939 11.2419 9.49292 11.3584L8.69069 12.1614L7.88846 11.3584C7.77199 11.2419 7.61403 11.1765 7.44932 11.1765C7.28461 11.1765 7.12665 11.2419 7.01019 11.3584C6.89372 11.4749 6.82829 11.6328 6.82829 11.7975C6.82829 11.9622 6.89372 12.1202 7.01019 12.2367L8.07001 13.2957V14.2803H4.96658C4.47274 14.2803 3.99912 14.0841 3.64991 13.7349C3.30071 13.3857 3.10453 12.9121 3.10453 12.4182V7.69402L7.13277 2.48726H10.2478L14.2768 7.69402V12.4182C14.2768 12.9121 14.0807 13.3857 13.7315 13.7349C13.3823 14.0841 12.9086 14.2803 12.4148 14.2803ZM16.1389 8.07341L11.6001 2.20562L14.8642 1.24589L16.1389 8.07341ZM6.82864 9.00444C6.82864 9.18858 6.77403 9.36858 6.67173 9.52169C6.56943 9.6748 6.42402 9.79413 6.2539 9.8646C6.08378 9.93506 5.89658 9.9535 5.71598 9.91758C5.53538 9.88165 5.36948 9.79298 5.23928 9.66278C5.10907 9.53257 5.0204 9.36668 4.98447 9.18607C4.94855 9.00547 4.96699 8.81828 5.03746 8.64815C5.10792 8.47803 5.22725 8.33262 5.38036 8.23032C5.53347 8.12802 5.71347 8.07341 5.89761 8.07341C6.14453 8.07341 6.38134 8.1715 6.55595 8.34611C6.73055 8.52071 6.82864 8.75752 6.82864 9.00444ZM12.4148 9.00444C12.4148 9.18858 12.3602 9.36858 12.2579 9.52169C12.1556 9.6748 12.0102 9.79413 11.8401 9.8646C11.6699 9.93506 11.4827 9.9535 11.3021 9.91758C11.1215 9.88165 10.9556 9.79298 10.8254 9.66278C10.6952 9.53257 10.6066 9.36668 10.5706 9.18607C10.5347 9.00547 10.5531 8.81828 10.6236 8.64815C10.6941 8.47803 10.8134 8.33262 10.9665 8.23032C11.1196 8.12802 11.2996 8.07341 11.4838 8.07341C11.7307 8.07341 11.9675 8.1715 12.1421 8.34611C12.3167 8.52071 12.4148 8.75752 12.4148 9.00444Z"/>
            </svg>
            <span>Perros</span>
          </button>

          <button
            class="pet-tab-button px-12 py-4 rounded-full border-2 flex items-center gap-4 font-semibold"
            data-pet="cat"
          >
            <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6.77531 10.1623C6.77531 10.3856 6.70909 10.6039 6.58501 10.7896C6.46093 10.9753 6.28456 11.1201 6.07823 11.2055C5.87189 11.291 5.64484 11.3134 5.42579 11.2698C5.20675 11.2262 5.00554 11.1187 4.84762 10.9607C4.68969 10.8028 4.58214 10.6016 4.53857 10.3826C4.495 10.1635 4.51736 9.93648 4.60283 9.73014C4.6883 9.5238 4.83303 9.34744 5.01873 9.22336C5.20443 9.09928 5.42276 9.03305 5.64609 9.03305C5.94558 9.03305 6.2328 9.15202 6.44457 9.36379C6.65634 9.57556 6.77531 9.86278 6.77531 10.1623ZM13.927 9.03305C13.7037 9.03305 13.4854 9.09928 13.2997 9.22336C13.114 9.34744 12.9692 9.5238 12.8838 9.73014C12.7983 9.93648 12.7759 10.1635 12.8195 10.3826C12.8631 10.6016 12.9706 10.8028 13.1286 10.9607C13.2865 11.1187 13.4877 11.2262 13.7067 11.2698C13.9258 11.3134 14.1528 11.291 14.3592 11.2055C14.5655 11.1201 14.7419 10.9753 14.8659 10.7896C14.99 10.6039 15.0562 10.3856 15.0562 10.1623C15.0562 9.86278 14.9373 9.57556 14.7255 9.36379C14.5137 9.15202 14.2265 9.03305 13.927 9.03305ZM19.5731 1.50493V9.78587C19.5731 14.7667 15.1833 18.8196 9.78656 18.8196C4.38984 18.8196 0 14.7667 0 9.78587V1.50493C0.00013794 1.20724 0.0885161 0.916283 0.253966 0.668813C0.419415 0.421342 0.65451 0.22847 0.929542 0.11457C1.20457 0.000670666 1.5072 -0.0291444 1.79917 0.0288927C2.09114 0.0869299 2.35935 0.230214 2.56991 0.440639C2.58309 0.453813 2.59438 0.466047 2.60567 0.479221L4.23457 2.35184C5.90011 1.30833 7.82583 0.7549 9.79127 0.7549C11.7567 0.7549 13.6824 1.30833 15.348 2.35184L16.9675 0.479221C16.9787 0.466047 16.99 0.453813 17.0032 0.440639C17.2138 0.230214 17.482 0.0869299 17.774 0.0288927C18.0659 -0.0291444 18.3686 0.000670666 18.6436 0.11457C18.9186 0.22847 19.1537 0.421342 19.3192 0.668813C19.4846 0.916283 19.573 1.20724 19.5731 1.50493ZM18.0675 1.50493L16.0387 3.83865C15.9146 3.98222 15.7408 4.07363 15.5522 4.09457C15.3636 4.11551 15.174 4.06443 15.0214 3.95157C14.5621 3.61203 14.0693 3.32036 13.5506 3.08113V5.26899C13.5506 5.46865 13.4713 5.66013 13.3301 5.80131C13.189 5.94249 12.9975 6.0218 12.7978 6.0218C12.5982 6.0218 12.4067 5.94249 12.2655 5.80131C12.1243 5.66013 12.045 5.46865 12.045 5.26899V2.54475C11.5511 2.41769 11.0475 2.33208 10.5394 2.28879V5.26899C10.5394 5.46865 10.4601 5.66013 10.3189 5.80131C10.1777 5.94249 9.98622 6.0218 9.78656 6.0218C9.5869 6.0218 9.39542 5.94249 9.25424 5.80131C9.11306 5.66013 9.03375 5.46865 9.03375 5.26899V2.28879C8.52563 2.33208 8.02201 2.41769 7.52812 2.54475V5.26899C7.52812 5.46865 7.44881 5.66013 7.30763 5.80131C7.16645 5.94249 6.97497 6.0218 6.77531 6.0218C6.57565 6.0218 6.38417 5.94249 6.24299 5.80131C6.10181 5.66013 6.0225 5.46865 6.0225 5.26899V3.08113C5.50383 3.32036 5.011 3.61203 4.55169 3.95157C4.39946 4.06476 4.2101 4.11631 4.02149 4.0959C3.83289 4.07548 3.65895 3.98462 3.53445 3.84147L1.50563 1.50493V9.78587C1.50563 13.7061 4.81894 16.9376 9.03375 17.2829V15.367L7.74832 14.0816C7.67844 14.0117 7.62302 13.9286 7.58522 13.8373C7.54743 13.7459 7.528 13.648 7.52804 13.5491C7.52808 13.4503 7.5476 13.3524 7.58548 13.261C7.62335 13.1697 7.67885 13.0867 7.74879 13.0168C7.89005 12.8757 8.08159 12.7965 8.28127 12.7966C8.38014 12.7966 8.47804 12.8161 8.56937 12.854C8.6607 12.8919 8.74367 12.9474 8.81355 13.0173L9.78656 13.9903L10.7596 13.0173C10.8295 12.9474 10.9124 12.8919 11.0038 12.854C11.0951 12.8161 11.193 12.7966 11.2919 12.7966C11.3907 12.7965 11.4886 12.8159 11.58 12.8537C11.6714 12.8915 11.7544 12.947 11.8243 13.0168C11.8943 13.0867 11.9498 13.1697 11.9876 13.261C12.0255 13.3524 12.045 13.4503 12.0451 13.5491C12.0451 13.648 12.0257 13.7459 11.9879 13.8373C11.9501 13.9286 11.8947 14.0117 11.8248 14.0816L10.5394 15.367V17.2829C14.7542 16.9357 18.0675 13.7071 18.0675 9.78587V1.50493Z"/>
            </svg>
            <span>Gatos</span>
          </button>
        </div>
      </div>

      {%- comment -%} MVIL: Carrusel horizontal de categor铆as - FULL WIDTH SIN SEPARACIN {%- endcomment -%}
      <div class="lg:hidden mb-12">
        <div class="categories-scroll flex gap-6 overflow-x-auto pb-2 -mx-6 px-6">
          {% for block in section.blocks %}
            {% if block.type == 'collection' %}
              <button
                class="category-button px-8 py-3 rounded-full border-2 whitespace-nowrap flex-shrink-0"
                style="border-color: {{ section.settings.accent_color }}; border:1px solid {{ section.settings.accent_color }};"
                data-pet-type="{{ block.settings.pet_type }}"
                data-collection="{{ block.settings.collection.handle }}"
                {{ block.shopify_attributes }}
              >
                {{ block.settings.collection_name }}
              </button>
            {% endif %}
          {% endfor %}
        </div>
      </div>

      {%- comment -%} Container principal con sidebar y contenido {%- endcomment -%}
      <div class="lg:flex lg:gap-48">
        {%- comment -%} DESKTOP: Sidebar de categor铆as {%- endcomment -%}
        <div class="hidden lg:block lg:w-96 flex-shrink-0">
          <div class="sticky top-40 space-y-3">
            {% for block in section.blocks %}
              {% if block.type == 'collection' %}
                <button
                  class="category-button w-full px-6 py-4 rounded-full border-2 transition-all"
                  style="border-color: {{ section.settings.accent_color }};"
                  data-pet-type="{{ block.settings.pet_type }}"
                  data-collection="{{ block.settings.collection.handle }}"
                  {{ block.shopify_attributes }}
                >
                  {{ block.settings.collection_name }}
                </button>
              {% endif %}
            {% endfor %}
          </div>
        </div>

        {%- comment -%} Contenido principal {%- endcomment -%}
        <div class="flex-1">
          {%- comment -%} Grid de productos {%- endcomment -%}
          <div id="products-container">
            {% for block in section.blocks %}
              {% if block.type == 'collection' %}
                <div
                  class="products-panel hidden"
                  data-pet-type="{{ block.settings.pet_type }}"
                  data-collection-panel="{{ block.settings.collection.handle }}"
                >
                  <div class="products-grid">
                    {% if block.settings.collection != blank %}
                      {% assign products_array = block.settings.collection.products %}
                      {% assign has_banner = false %}
                      {% if block.settings.banner_image != blank %}
                        {% assign has_banner = true %}
                      {% endif %}

                      {% for product in products_array limit: 50 %}
                        {% if has_banner and forloop.index == 3 %}
                          <div class="banner-wide lg:hidden">
                            {% render 'discount-banner-card',
                              banner_image: block.settings.banner_image,
                              action_type: block.settings.banner_action_type,
                              link_url: block.settings.banner_link_url,
                              banner_product: block.settings.banner_product
                            %}
                          </div>
                        {% endif %}

                        {% if has_banner and forloop.index == 7 %}
                          <div class="banner-wide hidden lg:block">
                            {% render 'discount-banner-card',
                              banner_image: block.settings.banner_image,
                              action_type: block.settings.banner_action_type,
                              link_url: block.settings.banner_link_url,
                              banner_product: block.settings.banner_product
                            %}
                          </div>
                        {% endif %}

                        {% render 'discount-product-card',
                          product: product,
                          countdown_date: block.settings.countdown_date,
                          section_id: section.id,
                          countdown_bg_color: section.settings.countdown_bg_color,
                          countdown_text_color: section.settings.countdown_text_color,
                          show_discount_badge: block.settings.show_discount_badge
                        %}
                      {% endfor %}
                    {% else %}
                      <p class="col-span-full text-center text-gray-500">No hay productos en esta colecci贸n</p>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const petButtons = document.querySelectorAll('[data-pet]');
    const categoryButtons = document.querySelectorAll('[data-collection]');
    const productPanels = document.querySelectorAll('[data-collection-panel]');

    let currentPet = 'dog';
    let currentCollection = null;

    function switchPet(petType) {
      currentPet = petType;

      petButtons.forEach((btn) => {
        if (btn.getAttribute('data-pet') === petType) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });

      const visibleCategories = [];
      categoryButtons.forEach((btn) => {
        if (btn.getAttribute('data-pet-type') === petType) {
          btn.style.display = '';
          btn.classList.remove('hidden');
          visibleCategories.push(btn);
        } else {
          btn.style.display = 'none';
          btn.classList.add('hidden');
        }
      });

      if (visibleCategories.length > 0) {
        const firstCategory = visibleCategories[0];
        const collectionHandle = firstCategory.getAttribute('data-collection');
        switchCollection(collectionHandle);
      }
    }

    // Funci贸n para cambiar de colecci贸n
    function switchCollection(collectionHandle) {
      currentCollection = collectionHandle;

      // Actualizar botones de categor铆as
      categoryButtons.forEach((btn) => {
        if (
          btn.getAttribute('data-collection') === collectionHandle &&
          btn.getAttribute('data-pet-type') === currentPet
        ) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });

      // Mostrar panel de productos correspondiente
      productPanels.forEach((panel) => {
        if (
          panel.getAttribute('data-collection-panel') === collectionHandle &&
          panel.getAttribute('data-pet-type') === currentPet
        ) {
          panel.classList.remove('hidden');
        } else {
          panel.classList.add('hidden');
        }
      });

      // Scroll suave al inicio de la secci贸n con offset de -50px (solo en desktop lg: 1024px+)
      if (window.innerWidth >= 1024) {
        const section = document.getElementById('section-{{ section.id }}');
        if (section) {
          const elementPosition = section.getBoundingClientRect().top + window.scrollY;
          const offsetPosition = elementPosition - 100;

          window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth',
          });
        }
      }

      // Reinicializar despu茅s de cambiar de panel
      setTimeout(() => {
        initProductCountdowns();
        initAddToCart();
      }, 100);
    }

    petButtons.forEach((btn) => {
      btn.addEventListener('click', function () {
        const petType = this.getAttribute('data-pet');
        switchPet(petType);
      });
    });

    categoryButtons.forEach((btn) => {
      btn.addEventListener('click', function () {
        const collectionHandle = this.getAttribute('data-collection');
        switchCollection(collectionHandle);
      });
    });

    function initProductCountdowns() {
      const countdownBadges = document.querySelectorAll('[data-countdown-end]');

      countdownBadges.forEach((badge) => {
        const endDateStr = badge.getAttribute('data-countdown-end');
        if (!endDateStr) return;

        const parts = endDateStr.split(' ');
        const datePart = parts[0];
        const timePart = parts[1] || '00:00';

        const isoDate = `${datePart}T${timePart}:00`;
        const endDate = new Date(isoDate).getTime();

        function updateCountdown() {
          const now = new Date().getTime();
          const distance = endDate - now;

          if (distance < 0) {
            badge.textContent = '00:00:00';
            return;
          }

          const totalHours = Math.floor(distance / (1000 * 60 * 60));
          const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((distance % (1000 * 60)) / 1000);

          const hoursStr = totalHours.toString().padStart(2, '0');
          const minutesStr = minutes.toString().padStart(2, '0');
          const secondsStr = seconds.toString().padStart(2, '0');

          badge.textContent = `${hoursStr}:${minutesStr}:${secondsStr}`;
        }

        updateCountdown();
        setInterval(updateCountdown, 1000);
      });
    }

    function initAddToCart() {
      const allButtons = document.querySelectorAll('[data-product-id]');

      allButtons.forEach((button) => {
        const hasVariants = button.getAttribute('data-has-variants');

        if (hasVariants === 'false') {
          const newButton = button.cloneNode(true);
          button.parentNode.replaceChild(newButton, button);

          newButton.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();

            const variantId = this.getAttribute('data-variant-id');
            const productAvailable = this.getAttribute('data-product-available') === 'true';

            if (!productAvailable || !variantId) {
              return;
            }

            const formData = {
              items: [
                {
                  id: parseInt(variantId, 10),
                  quantity: 1,
                },
              ],
            };

            fetch(window.Shopify.routes.root + 'cart/add.js', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                Accept: 'application/json',
              },
              body: JSON.stringify(formData),
            })
              .then((response) => response.json())
              .then((data) => {
                document.dispatchEvent(new CustomEvent('cart:refresh'));

                setTimeout(() => {
                  const cartButton = document.querySelector('[data-drawer-options*="t4s-mini_cart"]');
                  if (cartButton) {
                    cartButton.click();
                  }
                }, 100);
              })
              .catch((error) => {
                console.error('Error:', error);
              });
          });
        }
      });
    }

    switchPet('dog');
    initProductCountdowns();
    initAddToCart();
  });
</script>

{% schema %}
{
  "name": "Descuentos Especiales",
  "settings": [
    {
      "type": "header",
      "content": "T铆tulo"
    },
    {
      "type": "text",
      "id": "heading_before",
      "label": "T铆tulo (antes del resaltado)",
      "default": "Descuentos"
    },
    {
      "type": "text",
      "id": "heading_highlight",
      "label": "Texto resaltado",
      "default": "especiales"
    },
    {
      "type": "text",
      "id": "heading_after",
      "label": "T铆tulo (despu茅s del resaltado)"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Color del t铆tulo",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": " Fondos"
    },
    {
      "type": "color",
      "id": "outer_bg_color",
      "label": "Color de fondo exterior (visible en esquinas)",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Color de fondo interior (principal)",
      "default": "#2a2a2a"
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "Border radius (M贸vil)",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "border_radius_desktop",
      "label": "Border radius (Desktop)",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "inner_padding_mobile",
      "label": "Padding interior (M贸vil)",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "inner_padding_desktop",
      "label": "Padding interior (Desktop)",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 40
    },
    {
      "type": "header",
      "content": " Colores"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Color accent (categor铆as)",
      "default": "#004622"
    },
    {
      "type": "header",
      "content": " Colores - Countdown Badge"
    },
    {
      "type": "color",
      "id": "countdown_bg_color",
      "label": "Color de fondo del countdown",
      "default": "#F0807B"
    },
    {
      "type": "color",
      "id": "countdown_text_color",
      "label": "Color del texto del countdown",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": " Colores - Precios"
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Color del precio",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "compare_price_color",
      "label": "Color del precio tachado (Compare at Price)",
      "default": "#999999"
    },
    {
      "type": "header",
      "content": " Espaciado - Desktop"
    },
    {
      "type": "range",
      "id": "pt_desktop",
      "label": "Padding superior (Desktop)",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "default": 80
    },
    {
      "type": "range",
      "id": "pb_desktop",
      "label": "Padding inferior (Desktop)",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "default": 80
    },
    {
      "type": "header",
      "content": " Espaciado - M贸vil"
    },
    {
      "type": "range",
      "id": "pt_mobile",
      "label": "Padding superior (M贸vil)",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "pb_mobile",
      "label": "Padding inferior (M贸vil)",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Colecci贸n",
      "settings": [
        {
          "type": "text",
          "id": "countdown_date",
          "label": "憋 Fecha y hora de fin de cuenta atr谩s",
          "placeholder": "2025-12-20 23:00",
          "info": "Formato: YYYY-MM-DD HH:MM. Se aplicar谩 a todos los productos de esta colecci贸n"
        },
        {
          "type": "select",
          "id": "show_discount_badge",
          "label": "Mostrar badge superior",
          "options": [
            {
              "value": "countdown",
              "label": "Cuenta atr谩s (HH:MM:SS)"
            },
            {
              "value": "discount",
              "label": "Porcentaje de descuento (-X%)"
            },
            {
              "value": "none",
              "label": "Ninguno"
            }
          ],
          "default": "countdown",
          "info": "Elige qu茅 mostrar en la esquina superior derecha"
        },
        {
          "type": "select",
          "id": "pet_type",
          "label": "Tipo de mascota",
          "options": [
            {
              "value": "dog",
              "label": "Perro"
            },
            {
              "value": "cat",
              "label": "Gato"
            }
          ],
          "default": "dog"
        },
        {
          "type": "text",
          "id": "collection_name",
          "label": "Nombre de la categor铆a",
          "default": "Dieta BARF"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Colecci贸n"
        },
        {
          "type": "header",
          "content": "Banner promocional (opcional)"
        },
        {
          "type": "image_picker",
          "id": "banner_image",
          "label": "Imagen del banner"
        },
        {
          "type": "select",
          "id": "banner_action_type",
          "label": "Tipo de acci贸n del banner",
          "options": [
            {
              "value": "link",
              "label": "Enlace"
            },
            {
              "value": "product",
              "label": "A帽adir producto al carrito"
            }
          ],
          "default": "link"
        },
        {
          "type": "url",
          "id": "banner_link_url",
          "label": "URL del enlace",
          "info": "Solo si seleccionaste 'Enlace'"
        },
        {
          "type": "product",
          "id": "banner_product",
          "label": "Producto del banner",
          "info": "Solo si seleccionaste 'A帽adir producto al carrito'"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Descuentos Especiales",
      "blocks": [
        {
          "type": "collection",
          "settings": {
            "pet_type": "dog",
            "collection_name": "Dieta BARF"
          }
        },
        {
          "type": "collection",
          "settings": {
            "pet_type": "dog",
            "collection_name": "Comida Cocinada"
          }
        },
        {
          "type": "collection",
          "settings": {
            "pet_type": "cat",
            "collection_name": "Dieta BARF"
          }
        }
      ]
    }
  ]
}
{% endschema %}

<style>
  @media (max-width: 800px) {
    .t4s-product-quick-view .t4s-product__media-wrapper,
    .t4s-product-quick-view .t4s-product__review,
    .t4s-product-quick-view .t4s-product__title,
    .t4s-product-quick-view .t4s-product__price,
    .t4s-product-quick-view .t4s-product__line,
    .t4s-product-quick-view .t4s-product__description {
      display:none!important;
    }

    .t4s-product-quick-view .t4s-swatch__list {
      margin: unset;
    }
    .t4s-product-quick-view .space-x-4 > :not([hidden]) ~ :not([hidden]) {
      margin-left: 0;
    }
  }
  .t4s-product__description {
  display:none;
  }
</style>

<style>
    /* FIX PARA MODAL - VERSIN MEJORADA */
    .t4s-modal.t4s-modal--is-active {
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 9999 !important;
    }

    .t4s-modal.t4s-modal--is-active .t4s-modal__inner {
      visibility: visible !important;
      opacity: 1 !important;
    }

    .t4s-modal.t4s-modal--is-active .t4s-modal__content {
      visibility: visible !important;
      opacity: 1 !important;
      z-index: 10000 !important;
      height: auto !important;
    }

    /* Fix para el contenedor del slider Flickity que tiene height: 0 */
    .t4s-modal--is-active .flickityt4s-viewport {
      height: auto !important;
      min-height: 500px !important;
    }

    .t4s-modal--is-active .flickityt4s-carousel {
      height: auto !important;
    }

    /* Fix para overlay */
    .t4s-modal__overlay {
      z-index: 9998 !important;
    }

    /* Permitir que el bot贸n cerrar funcione */
    .t4s-modal__content .t4s-close-trigger,
    .t4s-modal__content [data-close],
    .t4s-modal [class*="close"],
    .t4s-modal [aria-label="Close"] {
      visibility: visible !important;
      opacity: 1 !important;
      pointer-events: auto !important;
      z-index: 10001 !important;
    }
    /* Estilos para botones de tabs */
  .pet-tab-button {
    transition: all 0.3s ease;
    min-width: 100px;
    justify-content: center;
    font-size: 11px;
  }

  @media (min-width: 1024px) {
    .pet-tab-button {
      font-size: 17px;
    }
  }

  .pet-tab-button.active {
    background-color: #5CCC84;
    color: white;
    border-color: #5CCC84;
  }

  .pet-tab-button.active svg path {
    fill: white;
  }

  .pet-tab-button:not(.active) {
    background-color: transparent;
    color: #5CCC84;
    border-color: #5CCC84;
    border-width: 1px;
    border: 1px solid;
  }

  .pet-tab-button:not(.active) svg path {
    fill: #5CCC84;
  }
</style>
