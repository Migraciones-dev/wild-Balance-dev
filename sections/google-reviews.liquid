{% comment %}
  Sección: Cómo funciona nuestra suscripción (editable desde el editor de temas)
  - Fondo, colores y assets configurables en "Ajustes"
  - Título dividido en prefijo + highlight
  - Cada card es un bloque con imagen, número, título y texto
  - Grid en escritorio / slider horizontal en móvil sin JS
{% endcomment %}

<section
  id="mig-suscripcion-{{ section.id }}"
  class="flex flex-col items-center gap-20 max-w-[1600px] mx-auto mig-section py-16 md:py-24"
  style="background-color: {{ section.settings.bg_color }};"
>
  <style>
    #mig-suscripcion-{{ section.id }}{
      --title-color: {{ section.settings.title_color }};
      --highlight-color: {{ section.settings.highlight_color }};
      --text-color: {{ section.settings.text_color }};
      --accent-color: {{ section.settings.accent_color }};
    }
    #mig-suscripcion-{{ section.id }} .mig-title{color:var(--title-color)}
    #mig-suscripcion-{{ section.id }} .mig-text{color:var(--text-color)}
    #mig-suscripcion-{{ section.id }} .highlight{color:var(--highlight-color)}
    #mig-suscripcion-{{ section.id }} .step-badge{background:var(--accent-color)}
    #mig-suscripcion-{{ section.id }} .btn-primary{background:var(--accent-color);color:var(--title-color)}
    #mig-suscripcion-{{ section.id }} .btn-primary:hover{opacity:.9}
    #mig-suscripcion-{{ section.id }} .no-scrollbar{scrollbar-width:none}
    #mig-suscripcion-{{ section.id }} .no-scrollbar::-webkit-scrollbar{display:none}
  </style>

  <!-- Título -->
  <div class="flex flex-col items-center gap-[13px] [@media(max-width:1024px)]:px-6">
    {% if section.settings.decor_image != blank %}
      <div class="flex flex-col items-center gap-2.5 relative overflow-hidden">
        <img
          class="relative h-[27px] sm:h-[37px] lg:h-[47px]"
          alt="{{ section.settings.decor_image_alt | escape }}"
          src="{{ section.settings.decor_image | image_url }}"
          loading="lazy"
        >
      </div>
    {% endif %}

    {% if section.settings.title_prefix %}
      <div class="relative w-full text-center [@media(max-width:1024px)]:px-6">
        <h2 class="mig-title [font-family:'Barlow',Helvetica] font-extrabold max-w-[1600px] text-[30px] lg:text-[64px] lg:text-center leading-[1]">
          {{ section.settings.title_prefix }}
          <span class="highlight">{{ section.settings.title_highlight }}</span>
        </h2>
      </div>
    {% endif %}
  </div>

  <!-- REVIEWS -->
  <!-- Carrusel de Reviews -->
  <section class="relative py-10">
    <!-- Gradientes laterales (fade) -->
    <div class="pointer-events-none absolute inset-y-0 left-0 w-16 bg-gradient-to-r from-white to-transparent"></div>
    <div class="pointer-events-none absolute inset-y-0 right-0 w-16 bg-gradient-to-l from-white to-transparent"></div>

    <div class="mx-auto max-w-7xl px-4">
      <div class="mb-6 flex items-center justify-between gap-4">
        <h2 class="text-xl font-semibold">Qué dicen en Google</h2>
        <div class="flex items-center gap-2">
          <button
            type="button"
            data-carousel-btn="prev"
            class="rounded-full border bg-white p-2 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring"
          >
            <!-- Left -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
          </button>
          <button
            type="button"
            data-carousel-btn="next"
            class="rounded-full border bg-white p-2 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring"
          >
            <!-- Right -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Track -->
      <ul
        id="reviews-track"
        class="
          flex gap-6 overflow-x-auto scroll-smooth snap-x snap-mandatory pb-2
          [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden
        "
      >
        <!-- Card -->
        <li class="snap-start">
          <article class="min-w-[280px] sm:min-w-[320px] md:min-w-[360px] max-w-sm rounded-2xl border bg-white p-5 shadow-sm transition hover:shadow-md">
            <header class="mb-3 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <img src="https://i.pravatar.cc/64?img=1" alt="" class="h-9 w-9 rounded-full object-cover">
                <div>
                  <p class="text-sm font-medium leading-none">Lorem ipsum</p>
                  <div class="mt-1 flex items-center gap-1" aria-label="5 de 5 estrellas">
                    <!-- Stars -->
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                  </div>
                </div>
              </div>
              <!-- Logo Google -->
              <svg class="h-5 w-5" viewBox="0 0 48 48">
                <path fill="#FFC107" d="M43.6 20.5H42V20H24v8h11.3C33.7 32.5 29.3 36 24 36a12 12 0 110-24c3 0 5.7 1.1 7.8 2.9l5.7-5.7C34.5 6.1 29.5 4 24 4 12.9 4 4 12.9 4 24s8.9 20 20 20 19.5-8.9 19.5-20c0-1.3-.1-2.2-.4-3.5z"/>
                <path fill="#FF3D00" d="M6.3 14.7l6.6 4.8C14.6 16.3 18.9 12 24 12c3 0 5.7 1.1 7.8 2.9l5.7-5.7C34.5 6.1 29.5 4 24 4 16.1 4 9.3 8.4 6.3 14.7z"/>
                <path fill="#4CAF50" d="M24 44c5.2 0 10.1-2 13.6-5.4l-6.3-5.2C29.2 35.7 26.8 36 24 36c-5.2 0-9.6-3.5-11.2-8.2l-6.6 5.1C9.2 39.6 16 44 24 44z"/>
                <path fill="#1976D2" d="M43.6 20.5H42V20H24v8h11.3c-1.3 3.9-5.4 6.5-11.3 6.5-5.2 0-9.6-3.5-11.2-8.2l-6.6 5.1C9.2 39.6 16 44 24 44c11.1 0 19.5-8.9 19.5-20 0-1.3-.1-2.2-.4-3.5z"/>
              </svg>
            </header>

            <p class="text-sm leading-6 text-gray-700">
              Lorem ipsum dolor sit amet consectetur. Quis nisl fermentum id vulputate nullam ut non mattis nibh.
              Tellus.
            </p>
          </article>
        </li>

        <!-- Duplica/varía más cards como necesites -->
        <li class="snap-start">
          <article class="min-w-[280px] sm:min-w-[320px] md:min-w-[360px] max-w-sm rounded-2xl border bg-white p-5 shadow-sm transition hover:shadow-md">
            <header class="mb-3 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <img src="https://i.pravatar.cc/64?img=12" alt="" class="h-9 w-9 rounded-full object-cover">
                <div>
                  <p class="text-sm font-medium leading-none">Dolor sit</p>
                  <div class="mt-1 flex items-center gap-1" aria-label="5 de 5 estrellas">
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                    <svg class="h-4 w-4 fill-yellow-400" viewBox="0 0 20 20">
                      <path d="M10 15l-5.878 3.09 1.122-6.545L.488 6.91l6.562-.953L10 0l2.95 5.957 6.562.953-4.756 4.635 1.122 6.545z"/>
                    </svg>
                  </div>
                </div>
              </div>
              <img src="https://www.gstatic.com/images/branding/product/1x/gsa_64dp.png" class="h-5 w-5" alt="Google">
            </header>
            <p class="text-sm leading-6 text-gray-700">Massa sed dui urna dis nam a eget faucibus dictum.</p>
          </article>
        </li>

        <!-- ...más items -->
      </ul>
    </div>
  </section>
  <script>
        <script>
      (() => {
        const track = document.getElementById('reviews-track');
        const prev = document.querySelector('[data-carousel-btn="prev"]');
        const next = document.querySelector('[data-carousel-btn="next"]');

        function getStep() {
          // ancho de card + gap
          const card = track.querySelector('li > article');
          const gap = parseFloat(getComputedStyle(track).columnGap || getComputedStyle(track).gap) || 0;
          return (card?.getBoundingClientRect().width || 320) + gap;
        }

        prev.addEventListener('click', () => track.scrollBy({ left: -getStep(), behavior: 'smooth' }));
        next.addEventListener('click', () => track.scrollBy({ left:  getStep(), behavior: 'smooth' }));
      })();
    </script>
  </script>

  <!-- Botón -->
  {% if section.settings.btn_label != blank and section.settings.btn_link != blank %}
    <a
      href="{{ section.settings.btn_link }}"
      class="shadow h-9 inline-flex items-center justify-center gap-2.5 py-8 px-12 rounded-[50px] btn-primary max-sm:w-[91%] md:w-1/2 lg:w-auto text-[18px] [@media(max-width:1024px)]:mx-6"
    >
      <span class="[font-family:'DM_Sans_18pt-SemiBold',Helvetica] font-semibold text-[18px]">
        {{- section.settings.btn_label -}}
      </span>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-[15px] h-[15px] ml-2"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
        aria-hidden="true"
      >
        <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14M12 5l7 7-7 7" />
      </svg>
    </a>
  {% endif %}
</section>

{% schema %}
{
  "name": "Migraciones reviews",
  "tag": "section",
  "class": "t4s-section t4s-section-all t4s-custom-liquid",
  "settings": [
    { "type": "header", "content": "Contenido" },
    { "type": "text", "id": "title_prefix", "label": "Título – prefijo", "default": "Cómo funciona" },
    { "type": "text", "id": "title_highlight", "label": "Título – highlight", "default": "nuestra suscripción" },

    { "type": "image_picker", "id": "decor_image", "label": "Imagen decorativa (opcional)" },
    { "type": "text", "id": "decor_image_alt", "label": "Alt imagen decorativa", "default": "Decorativo" },

    { "type": "url", "id": "cards_link", "label": "Enlace de las cards (opcional)" },

    { "type": "header", "content": "Botón" },
    { "type": "text", "id": "btn_label", "label": "Texto del botón", "default": "Empezar mi plan con un -10%" },
    { "type": "url", "id": "btn_link", "label": "Enlace del botón" },

    { "type": "header", "content": "Colores" },
    { "type": "color", "id": "bg_color", "label": "Fondo de la sección", "default": "#ffffff" },
    { "type": "color", "id": "title_color", "label": "Color del título y números", "default": "#004623" },
    { "type": "color", "id": "highlight_color", "label": "Color del highlight", "default": "#004623" },
    { "type": "color", "id": "text_color", "label": "Color de textos", "default": "#004623" },
    { "type": "color", "id": "accent_color", "label": "Color acento (badge/botón)", "default": "#FFCD00" }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Imagen" },
        { "type": "text", "id": "image_alt", "label": "Alt de la imagen", "default": "Imagen card" },
        {
          "type": "text",
          "id": "step_number",
          "label": "Número del paso (opcional)",
          "info": "Si se deja vacío, usa el índice (1,2,3...)"
        },
        { "type": "text", "id": "card_title", "label": "Título", "default": "Título de la card" },
        { "type": "textarea", "id": "card_text", "label": "Texto", "default": "Descripción breve del paso." }
      ]
    }
  ],
  "max_blocks": 3,
  "presets": [
    {
      "name": "Migraciones reviews",
      "blocks": [
        {
          "type": "card",
          "settings": {
            "card_title": "Crea tu plan",
            "card_text": "Cuéntanos un poco sobre tu peludo en menos de 2 min."
          }
        },
        {
          "type": "card",
          "settings": {
            "card_title": "Pruébalo con un 10%",
            "card_text": "Te enviaremos una caja con un descuento especial para que pruebes comida de la mejor calidad."
          }
        },
        {
          "type": "card",
          "settings": {
            "card_title": "Enamórate",
            "card_text": "Si os encanta, solo elige la frecuencia de entrega. Sin permanencia, 100% flexible."
          }
        }
      ]
    }
  ]
}
{% endschema %}
